<!doctype html>
<html lang="es">

<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<meta name="description" content="Evento en Lippu" />
<title>Lippu · Evento</title>

<!-- Google Fonts: Montserrat (Black/Bold) & Inter -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Montserrat:wght@700;900&display=swap"
  rel="stylesheet">

<link rel="stylesheet" href="/src/style.css">
<script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
</head>
</style>

<script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
</head>

<body>
  <div id="root"></div>

  <script>
    if (window.netlifyIdentity) {
      window.netlifyIdentity.on("init", user => {
        if (!user) {
          window.netlifyIdentity.on("login", () => {
            document.location.href = "/admin/";
          });
        }
      });
    }
  </script>

  <script type="module">
    import { getSlug, loadEvent } from "./src/main.js";
    import { renderEvent } from "./src/render.js";

    (async () => {
      try {
        const slug = getSlug();
        const data = await loadEvent(slug);
        await renderEvent(data);
      } catch (e) {
        console.error("Error loading event:", e);
        document.getElementById("root").innerHTML = `
          <div class="card">
            <div class="muted">Lippu</div>
            <h1>Evento no encontrado</h1>
            <p class="muted">No hay configuración para <b>${slug}</b>.</p>
            <div class="divider"></div>
            <p class="muted" style="word-break:break-word;">${String(e.message || e)}</p>
            <div class="row" style="margin-top:12px;">
              <a class="btn secondary" href="https://lippu.app" rel="noopener">Ir a Lippu</a>
            </div>
          </div>
        `;
      }
    })();
  </script>
</body>

</html>