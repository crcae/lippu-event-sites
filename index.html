<!doctype html>
<html lang="es">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="Evento en Lippu" />
  <title>Lippu · Evento</title>

  <!-- Google Fonts: Montserrat & Inter -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Montserrat:wght@700;900&display=swap"
    rel="stylesheet">

  <link rel="stylesheet" href="/src/style.css">
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
</head>

<body>
  <div id="root"></div>

  <script>
    if (window.netlifyIdentity) {
      window.netlifyIdentity.on("init", user => {
        if (!user) {
          window.netlifyIdentity.on("login", () => {
            document.location.href = "/admin/";
          });
        }
      });
    }
  </script>

  <script type="module">
    import { getSlug, loadEvent } from "./src/main.js";
    import { renderEvent } from "./src/render.js";

    (async () => {
      const root = document.getElementById("root");
      let slug = "demo";

      try {
        slug = getSlug();
        const data = await loadEvent(slug);
        await renderEvent(data);
      } catch (e) {
        console.error("Error loading event:", e);
        root.innerHTML = `
          <div class="card" style="max-width: 500px; margin: 100px auto; padding: 40px; text-align: center; background: rgba(255,255,255,0.05); border-radius: 20px;">
            <div style="opacity: 0.5; margin-bottom: 10px;">Lippu</div>
            <h1 style="margin-bottom: 20px;">Evento no encontrado</h1>
            <p style="opacity: 0.7;">No se pudo cargar la configuración para: <b>${slug}</b></p>
            <div style="height: 1px; background: rgba(255,255,255,0.1); margin: 20px 0;"></div>
            <p style="opacity: 0.5; font-size: 0.8rem; word-break: break-all;">${String(e.message || e)}</p>
            <div style="margin-top: 30px;">
              <a href="https://lippu.app" style="color: #109bff; text-decoration: none; font-weight: bold;">Ir a Lippu.app</a>
            </div>
          </div>
        `;
      }
    })();
  </script>
</body>

</html>